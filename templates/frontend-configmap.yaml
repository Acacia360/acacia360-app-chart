# Frontend ConfigMap
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "acacia360-app-chart.fullname" . }}-frontend-config
  labels:
    {{- include "acacia360-app-chart.labels" . | nindent 4 }}
    app: acacia360-frontend
data:
  nginx.conf: |
    server {
      listen 80;
      server_name {{ .Values.frontend.ingress.host | default "acacia360.local" }};

      root /usr/share/nginx/html;
      index index.html;

      # Static files
      location /assets/ {
          try_files $uri =404;
      }

      location /static/ {
          try_files $uri =404;
      }

      location ~* \.(?:js|css|png|jpg|jpeg|gif|ico|svg|woff2?|ttf|eot)$ {
          try_files $uri =404;
          expires max;
          access_log off;
      }

      # React SPA fallback
      location / {
          try_files $uri $uri/ /index.html;
      }
    }